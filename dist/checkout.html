<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/style.min.css">
    <script src="./js/country-states.js"></script>
</head>

<body class="body">

//MAININFORMATION

<div class="checkout">
    <div class="secure_checkout">
        <h2><i class="fa fa-user-lock"></i> Secure Checkout</h2>
        <form action="" name="mainform" >
            <h3><i class="fa fa-user"></i> CUSTOMER INFORMATION</h3>
            <div>
                <label for="full-name"></label>
                <input type="text" id="full-name" name="full-name" placeholder="Your Full Name">
                <label for="phone"></label>
                <input type="text" id="phone" name="phone" placeholder="Phone">
                <label for="email"></label>
                <input type="text" id="email" name="email" placeholder="Email address">
            </div>

            //BILLING

            <h3>BILLING INFORMATION</h3>
            <div>
                <label for="billing-address"></label>
                <input type="text" id="billing-address" name="billing-address" placeholder="Your billing address"
                >
                <div>
                    <label for="country">Country</label>
                    <select id="country">
                        <option>select country</option>
                    </select>
                </div>
                <div>
                    <label for="state">State</label>
                    <span id="state-code"><input type="text" id="state"></span>
                </div>
                <label for="zip-code"></label>
                <input type="text" id="zip-code" name="zip-code" placeholder="Zip code">
                <label for="city"></label>
                <input type="text" id="city" name="city" placeholder="City">
                <label>
                    <input type="checkbox" checked="checked" name="sameadr"> Shipping address same as billing
                </label>
                <label>
                    <input type="checkbox" checked="checked" name="auto-refill">Auto Refill (optional)
                </label>
            </div>

            //PAYMENT

            <h3>PAIMENT DETAILS</h3>
            <div>
                <label for="card-number"></label>
                <input type="text" id="card-number" name="card-number" placeholder="Card number">

                <label for="exp-date">Card expiration date</label>
                <input type="text" id="exp-date" name="exp-date" placeholder="MM/YYYY">

                <label for="cvv"></label>
                <input type="text" id="cvv" name="cvv" placeholder="CVV">
            </div>
            <input type="submit" value="Buy Now" class="btn" id="submitButton">
        </form>
    </div>
    <div class="order_details">
        <h2><i class="fa fa-shopping-cart"></i> Order Details</h2>

        <div>
            <img src="./images/img/Trivexa_BioCleanse_TBD_Bottle6.png" alt="Trivexa_BioCleanse_TBD_Bottle">
            <span>90 Day Supply</span>
        </div>

        <div class="price-panel">
            <div class="row normal">
                <span class="key">Normal Price</span>
                <span class="value">$999.00</span>
            </div>
            <div class="row">
                <span class="key">Your Price</span>
                <span class="value">$294.00</span>
            </div>
            <div class="row">
                <span class="key">Shipping & Handling</span>
                <span class="value">$0.00</span>
            </div>
            <div class="row">
                <span class="key">Taxes</span>
                <span class="value">$0.00</span>
            </div>
            <div class="row total">
                <span class="key">Total (USD)</span>
                <span class="value">$294.00</span>
            </div>
        </div>

    </div>
</div>
<script>
    // user country code for selected option
    let user_country_code = "US";

    (function () {
        // script https://www.html-code-generator.com/html/drop-down/country-region

        // Get the country name and state name from the imported script.
        let country_list = country_and_states['country'];
        let states_list = country_and_states['states'];

        // creating country name drop-down
        let option = '';
        option += '<option>select country</option>';
        for (let country_code in country_list) {
            // set selected option user country
            let selected = (country_code == user_country_code) ? ' selected' : '';
            option += '<option value="' + country_code + '"' + selected + '>' + country_list[country_code] + '</option>';
        }
        document.getElementById('country').innerHTML = option;

        // creating states name drop-down
        let text_box = '<input type="text" class="input-text" id="state">';
        let state_code_id = document.getElementById("state-code");

        function create_states_dropdown() {
            // get selected country code
            let country_code = document.getElementById("country").value;
            let states = states_list[country_code];
            // invalid country code or no states add textbox
            if (!states) {
                state_code_id.innerHTML = text_box;
                return;
            }
            let option = '';
            if (states.length > 0) {
                option = '<select id="state">\n';
                for (let i = 0; i < states.length; i++) {
                    option += '<option value="' + states[i].code + '">' + states[i].name + '</option>';
                }
                option += '</select>';
            } else {
                // create input textbox if no states
                option = text_box
            }
            state_code_id.innerHTML = option;
        }

        // country select change event
        const country_select = document.getElementById("country");
        country_select.addEventListener('change', create_states_dropdown);

        create_states_dropdown();
    })();
    let konnektiveForm = document.forms.mainform
    konnektiveForm.addEventListener('submit', (e) => {
        e.preventDefault()
        let url = 'https://api.konnektive.com/order/import/?loginId=testOne&password=StartUp2022!&product1_id=1&campaignId=2' +
            '&firstName=testOneName&lastName=testOneLastName&emailAddress=forsalenn@gmail.com&phoneNumber=1234432432&paySource=' +
            'CREDITCARD&cardNumber=7775967474242349&cardMonth=11&cardYear=2024&cardSecurityCode=123&shipAddress1=455+Hollywood+Blvd' +
            '&address1=455+Hollywood+Blvd&postalCode=12344213&city=Rome&country=Italy&shipCity=Rome&shipCountry=Italy&shipPostalCode=12344213'
        fetch(url,{
            method: 'POST',

            headers: {
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Request-Method": "*"
            }
        }).then(data => {
            console.log(data)
        }).catch(err => {
            console.log(err)
        })
    })
    console.log(konnektiveForm.phone)

</script>
<script src="https://kit.fontawesome.com/516b7c7472.js" crossorigin="anonymous"></script>
</body>

</html>